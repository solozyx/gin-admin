
4b6860425c71049e68cc263174495453
{
	"account_no":"18813141012",
	"password":"asdf1234"
}
{
    "code": 20115,
    "msg": "您的账号已被删除; 18813141012"
}
{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/mine/login{\"account_no\":\"18813141012\",\"password\":\"asdf1234\"}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-06-16T18:56:56+08:00"}
{"level":"debug","msg":"server sign: 4b6860425c71049e68cc263174495453, \tuser sign: 4b6860425c71049e68cc263174495453","source":"context.go:161:gin.(*Context).Next","time":"2020-06-16T18:56:56+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/login JWT 不验证token","source":"context.go:161:gin.(*Context).Next","time":"2020-06-16T18:56:56+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/login middleware Casbin 不验证权限","source":"context.go:161:gin.(*Context).Next","time":"2020-06-16T18:56:56+08:00"}
{"level":"debug","msg":"mineService Login req={AccountNo:18813141012 Password:asdf1234}","source":"mine.go:68:handler.(*mineHandler).Login.func1","time":"2020-06-16T18:56:56+08:00"}
{"level":"info","msg":"sqlC:/oben/project/backstage/repository/user.go:6119.9492msSELECT * FROM `bs_user`  WHERE (phone=? OR email=?) ORDER BY `bs_user`.`id` ASC LIMIT 1[18813141012 18813141012] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-06-16T18:56:56+08:00"}
{"level":"debug","msg":"userRepo SignIn accountNo=18813141012 user=\u0026{ID:13 Password:51f22a1d702815e72b593ca36de88a9c9999e57a RealName:姓名12 Email:user12@email.com Phone:18813141012 UserStatus:2 CreatorId:1 OrganizationId:0 DepartmentId:0 Desc:用户12 CreatedAt:2020-06-16 16:12:01 +0800 CST UpdatedAt:2020-06-16 17:58:39 +0800 CST}","source":"mine.go:79:service.(*mineService).Login","time":"2020-06-16T18:56:56+08:00"}
{"level":"error","msg":"您的账号已被删除; 18813141012","source":"casbin.go:34:middleware.CasbinVerifyUserPermission.func1","time":"2020-06-16T18:56:56+08:00"}



mysql> update bs_user set user_status=0 where id=13;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0
mysql> select * from bs_user where id=13;
+----+------------------------------------------+-----------+------------------+-------------+-------------+------------+-----------------+---------------+----------+---------------------+---------------------+
| id | password                                 | real_name | email            | phone       | user_status | creator_id | organization_id | department_id | desc     | created_at          | updated_at          |
+----+------------------------------------------+-----------+------------------+-------------+-------------+------------+-----------------+---------------+----------+---------------------+---------------------+
| 13 | 51f22a1d702815e72b593ca36de88a9c9999e57a | 姓名12    | user12@email.com | 18813141012 |           0 |          1 |               0 |             0 | 用户12   | 2020-06-16 16:12:01 | 2020-06-16 18:58:21 |
+----+------------------------------------------+-----------+------------------+-------------+-------------+------------+-----------------+---------------+----------+---------------------+---------------------+
1 row in set (0.00 sec)
mysql>

{
    "code": 20114,
    "msg": "您的账号已被冻结; 18813141012"
}

mysql> update bs_user set user_status=1 where id=13;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0
mysql> select * from bs_user where id=13;
+----+------------------------------------------+-----------+------------------+-------------+-------------+------------+-----------------+---------------+----------+---------------------+---------------------+
| id | password                                 | real_name | email            | phone       | user_status | creator_id | organization_id | department_id | desc     | created_at          | updated_at          |
+----+------------------------------------------+-----------+------------------+-------------+-------------+------------+-----------------+---------------+----------+---------------------+---------------------+
| 13 | 51f22a1d702815e72b593ca36de88a9c9999e57a | 姓名12    | user12@email.com | 18813141012 |           1 |          1 |               0 |             0 | 用户12   | 2020-06-16 16:12:01 | 2020-06-16 18:59:20 |
+----+------------------------------------------+-----------+------------------+-------------+-------------+------------+-----------------+---------------+----------+---------------------+---------------------+
1 row in set (0.00 sec)
mysql>


{
    "code": 0,
    "msg": "SUCCESS",
    "data": {
        "access_token": "eyJhbGciOiJIUzI1NiIsImN0eSI6IkpXVCIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzZWNvbmRjaGFzZS5nYXRld2F5Iiwic3ViIjoiQWNjZXNzVG9rZW4iLCJhdWQiOiJodHRwczovL2JhY2tzdGFnZS5vYmVuY24uY29tIiwiZXhwIjoxNTkyMzkxNTkwLCJuYmYiOjE1OTIzMDQ4OTAsImlhdCI6MTU5MjMwNTE5MCwianRpIjoiYmM2MDkxNGEtMDcxNy00Y2VkLWFhMjctMzU1ZjQ0YThlMzNjIiwidXNlcl9pZCI6MTN9.gPH--IRXg8cNWH0R5MQPFxeBHW_9ZyNDRF3gCGxIlwE",
        "refresh_token": "eyJhbGciOiJIUzI1NiIsImN0eSI6IkpXVCIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJiYWNrc3RhZ2UuZ2F0ZXdheSIsInN1YiI6IlJlZnJlc2hUb2tlbiIsImF1ZCI6Imh0dHBzOi8vYmFja3N0YWdlLm9iZW5jbi5jb20iLCJleHAiOjE1OTQ4OTcxOTAsIm5iZiI6MTU5MjMwNDg5MCwiaWF0IjoxNTkyMzA1MTkwLCJqdGkiOiI3MGRlNTJlMS05YmEwLTQ3MDItYjAyNC1iN2RkMzM4OGMyODUiLCJ1c2VyX2lkIjoxM30.UGhfxwFUdiMVlOHGasAaBSDIWBoOHiz-Elr2SWEZFwk",
        "user_info": {
            "id": 13,
            "real_name": "姓名12",
            "email": "user12@email.com",
            "phone": "18813141012",
            "creator_id": 1,
            "organization_id": 0,
            "department_id": 0,
            "desc": "用户12",
            "created_at": "2020-06-16T16:12:01+08:00",
            "updated_at": "2020-06-16T18:59:20+08:00"
        }
    }
}

{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/mine/login{\"account_no\":\"18813141012\",\"password\":\"asdf1234\"}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-06-16T19:00:16+08:00"}
{"level":"debug","msg":"server sign: 4b6860425c71049e68cc263174495453, \tuser sign: 4b6860425c71049e68cc263174495453","source":"context.go:161:gin.(*Context).Next","time":"2020-06-16T19:00:16+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/login JWT 不验证token","source":"context.go:161:gin.(*Context).Next","time":"2020-06-16T19:00:16+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/login middleware Casbin 不验证权限","source":"context.go:161:gin.(*Context).Next","time":"2020-06-16T19:00:16+08:00"}
{"level":"debug","msg":"mineService Login req={AccountNo:18813141012 Password:asdf1234}","source":"mine.go:68:handler.(*mineHandler).Login.func1","time":"2020-06-16T19:00:16+08:00"}
{"level":"info","msg":"sqlC:/oben/project/backstage/repository/user.go:6122.938msSELECT * FROM `bs_user`  WHERE (phone=? OR email=?) ORDER BY `bs_user`.`id` ASC LIMIT 1[18813141012 18813141012] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-06-16T19:00:16+08:00"}
{"level":"debug","msg":"userRepo SignIn accountNo=18813141012 user=\u0026{ID:13 Password:51f22a1d702815e72b593ca36de88a9c9999e57a RealName:姓名12 Email:user12@email.com Phone:18813141012 UserStatus:1 CreatorId:1 OrganizationId:0 DepartmentId:0 Desc:用户12 CreatedAt:2020-06-16 16:12:01 +0800 CST UpdatedAt:2020-06-16 18:59:20 +0800 CST}","source":"mine.go:79:service.(*mineService).Login","time":"2020-06-16T19:00:16+08:00"}
{"level":"debug","msg":"userRepo SignIn 密码校验通过  数据库密码=51f22a1d702815e72b593ca36de88a9c9999e57a 输入密码=51f22a1d702815e72b593ca36de88a9c9999e57a","source":"mine.go:79:service.(*mineService).Login","time":"2020-06-16T19:00:16+08:00"}

