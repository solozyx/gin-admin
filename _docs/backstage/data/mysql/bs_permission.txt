
部门管理    权限管理            角色管理            用户管理         数据管理    (角色名称)
-------------------------------------------------------------------------------------------
创建部门    --系统权限列表--    创建角色            创建用户         创建数据    (权限条目)
删除部门    创建权限            角色权限添加        删除用户         更新数据
冻结部门                        角色权限减少        冻结用户         删除数据
编辑部门                                            用户角色添加
                                                    用户角色减少
                                                    用户角色列表
                                                    用户权限列表

user1   系统管理员   角色列表    [部门管理,权限管理,角色管理,用户管理,数据管理]
user2   部门管理员   角色列表    [角色管理,用户管理,数据管理]
user3   部门运营     角色列表    [数据管理]




系统管理(1级)          用户管理(2级)     数据管理(3级) (角色名称,可能表述不准确)
-------------------------------------------------------------------------------------------
部门创建               用户创建          创建数据      (权限条目)
部门编辑               用户冻结          更新数据
部门冻结               用户删除          删除数据
部门删除               用户角色添加
权限创建               用户角色减少
权限编辑               用户角色列表
权限冻结               用户权限列表
权限删除
角色创建
角色编辑
角色冻结
角色删除
角色权限添加
角色权限减少

user1   系统管理员   角色列表    [1级,2级,3级]
user2   部门管理员   角色列表    [2级,3级]
user3   部门运营     角色列表    [3级]


INSERT INTO `bs_permission` (`name`,`permission_status`,`method`,`path`,`creator_id`,`desc`,`created_at`,`updated_at`)
 VALUES (?,?,?,?,?,?,?,?)
  [权限列表 1 POST /api/v1/user/permlist 1  2020-05-29 11:26:39.8565961 +0800 CST m=+0.113279301 2020-05-29 11:26:39.8689033 +0800 CST m=+0.125586501] 1


系统管理(1级)          用户管理(2级)     数据管理(3级) (角色名称,可能表述不准确)
-------------------------------------------------------------------------------------------
部门创建               用户创建          创建数据      (权限条目)
权限创建               用户冻结          更新数据
角色创建               用户删除          删除数据
角色权限添加           用户角色添加
角色权限减少           用户角色减少
                       用户角色列表
                       用户权限列表

user1   系统管理员   角色列表    [1级,2级,3级]
user2   部门管理员   角色列表    [2级,3级]
user3   部门运营     角色列表    [3级]

业务数据用部门id隔离
权限和角色数据系统(各组织)共用



mysql> select * from bs_permission;
+----+--------------------+---------+------------+-------------+--------+----------------------------+------------+------+---------------------+---------------------+
| id | name               | menu_id | element_id | perm_status | method | path                       | creator_id | desc | created_at          | updated_at          |
+----+--------------------+---------+------------+-------------+--------+----------------------------+------------+------+---------------------+---------------------+
|  1 | 创建组织           |       0 |          0 |           1 | POST   | /api/v1/org/create         |          0 |      | 2020-05-14 17:28:03 | 2020-07-10 13:49:18 |
|  2 | 删除组织           |       0 |          0 |           1 | POST   | /api/v1/org/delete         |          0 |      | 2020-05-14 17:29:01 | 2020-07-10 13:49:18 |
|  3 | 创建部门           |       0 |          0 |           1 | POST   | /api/v1/dep/create         |          0 |      | 2020-05-14 18:02:24 | 2020-07-10 13:49:18 |
|  4 | 删除部门           |       0 |          0 |           1 | POST   | /api/v1/dep/delete         |          0 |      | 2020-05-14 18:06:01 | 2020-07-10 13:49:18 |
|  5 | 创建成员           |       3 |          0 |           1 | POST   | /api/v1/user/create        |          0 |      | 2020-05-15 14:50:46 | 2020-07-21 14:29:09 |
|  6 | 删除成员           |       0 |          0 |           1 | POST   | /api/v1/user/delete        |          0 |      | 2020-05-15 14:51:59 | 2020-07-10 13:49:18 |
|  7 | 冻结成员           |       0 |          0 |           1 | POST   | /api/v1/user/disable       |          0 |      | 2020-05-15 14:53:53 | 2020-07-10 13:49:18 |
|  8 | 组织列表           |       0 |          0 |           1 | GET    | /api/v1/org/list           |          0 |      | 2020-05-15 14:55:04 | 2020-07-10 13:49:18 |
|  9 | 组织部门列表       |       0 |          0 |           1 | POST   | /api/v1/org/deplist        |          0 |      | 2020-05-15 15:06:14 | 2020-07-10 13:49:18 |
| 10 | 成员列表           |       2 |          0 |           1 | POST   | /api/v1/user/list          |          0 |      | 2020-05-15 15:06:56 | 2020-07-21 14:04:50 |
| 11 | 角色列表           |       0 |          0 |           1 | GET    | /api/v1/role/list          |          0 |      | 2020-05-19 15:51:52 | 2020-07-21 14:48:41 |
| 12 | 创建角色           |       0 |          1 |           1 | POST   | /api/v1/role/create        |          0 |      | 2020-05-19 17:22:07 | 2020-07-21 14:48:33 |
| 13 | 角色权限添加       |       0 |          0 |           1 | POST   | /api/v1/role/permadd       |          0 |      | 2020-05-21 14:35:14 | 2020-07-10 13:49:18 |
| 14 | 用户角色添加       |       0 |          0 |           1 | POST   | /api/v1/user/roleadd       |          0 |      | 2020-05-29 11:20:06 | 2020-07-10 13:49:18 |
| 15 | 用户角色列表       |       0 |          0 |           1 | POST   | /api/v1/user/rolelist      |          0 |      | 2020-05-29 11:22:27 | 2020-07-10 16:25:48 |
| 16 | 用户权限列表       |       0 |          0 |           1 | POST   | /api/v1/user/permlist      |          0 |      | 2020-05-29 11:23:39 | 2020-07-10 16:26:17 |
| 17 | 角色权限列表       |       0 |          0 |           1 | POST   | /api/v1/role/permlist      |          0 |      | 2020-05-29 11:24:12 | 2020-07-10 18:02:34 |
| 18 | 导出成员           |       0 |          0 |           1 | POST   | /api/v1/user/export        |          0 |      | 2020-05-29 11:25:06 | 2020-07-13 15:54:01 |
| 19 | 导出成员日志       |       4 |          0 |           1 | POST   | /api/v1/user/exportlog     |          0 |      | 2020-05-29 11:25:37 | 2020-07-21 14:29:09 |
| 20 | 成员编辑           |       0 |          0 |           1 | POST   | /api/v1/user/edit          |          0 |      | 2020-05-29 11:26:12 | 2020-07-13 15:54:32 |
| 21 | 解冻成员           |       0 |          0 |           1 | POST   | /api/v1/user/enable        |          0 |      | 2020-05-29 11:26:40 | 2020-07-13 15:56:00 |
| 22 | 新增单条语料       |       0 |          0 |           1 | POST   | /api/v1/corpus/create      |          0 |      | 2020-05-29 11:26:40 | 2020-07-21 15:30:58 |
| 23 | 批量新增语料       |       0 |          0 |           1 | POST   | /api/v1/corpus/batchcreate |          0 |      | 2020-05-29 11:26:40 | 2020-07-21 15:30:58 |
| 24 | 语料列表           |       5 |          0 |           1 | POST   | /api/v1/corpus/list        |          0 |      | 2020-05-29 11:26:40 | 2020-07-21 15:32:01 |
| 25 | 创建意图           |       0 |          0 |           1 | POST   | /api/v1/intention/create   |          0 |      | 2020-05-29 11:26:40 | 2020-07-21 15:30:58 |
| 26 | 意图列表           |       0 |          0 |           1 | GET    | /api/v1/intention/list     |          0 |      | 2020-05-29 11:26:40 | 2020-07-22 11:41:05 |
| 27 | 编辑语料           |       0 |          0 |           1 | POST   | /api/v1/corpus/edit        |          0 |      | 2020-05-29 11:26:40 | 2020-07-22 17:43:40 |
| 28 | 审核语料           |       0 |          0 |           1 | POST   | /api/v1/audit/corpus       |          0 |      | 2020-05-29 11:26:40 | 2020-07-23 16:42:59 |
| 29 | 语料删除           |       0 |          0 |           1 | POST   | /api/v1/corpus/delete      |          0 |      | 2020-05-29 11:26:40 | 2020-07-23 17:50:19 |
+----+--------------------+---------+------------+-------------+--------+----------------------------+------------+------+---------------------+---------------------+
29 rows in set (0.00 sec)
mysql>









update bs_permission set menu_id=0,element_id=0 where id>=22;
update bs_permission set menu_id=5 where id=24;


select * from bs_permission where menu_id<>0 or element_id<>0;


INSERT INTO `bs_permission` (`name`,`perm_status`,`method`,`path`,`creator_id`,`desc`,`created_at`,`updated_at`)
VALUES ('demo',1,'POST','/api',0,'','2020-05-29 11:26:40','2020-07-13 15:56:00');


update bs_permission set name='语料删除', perm_status=1,path='/api/v1/corpus/delete' where id=29;


一级管理员root
[
    |  1 | 创建组织
    |  2 | 删除组织
    |  3 | 创建部门
    |  4 | 删除部门
    |  5 | 创建成员
    |  6 | 删除成员
    |  7 | 冻结成员
    |  8 | 组织列表
    |  9 | 组织部门列表
    | 10 | 成员列表
    | 11 | 角色列表
    | 14 | 用户角色添加
    | 15 | 用户角色列表
    | 16 | 用户权限列表
    | 17 | 角色权限列表
]



二级管理员admin
[
    |  3 | 创建部门
    |  4 | 删除部门
    |  5 | 创建成员
    |  6 | 删除成员
    |  7 | 冻结成员
    |  8 | 组织列表
    |  9 | 组织部门列表
    | 10 | 成员列表
    | 11 | 角色列表
    | 12 | 创建角色
    | 13 | 角色权限添加
    | 14 | 用户角色添加
    | 15 | 用户角色列表
    | 16 | 用户权限列表
    | 17 | 角色权限列表
]


上海分行普通成员1
[
    | 22 | 新增单条语料
    | 23 | 批量新增语料
    | 24 | 语料列表
]


mysql> select id,name,perm_status,method,path,creator_id,`desc` from bs_permission where id=2;
+----+--------------+-------------+--------+--------------------+------------+------+
| id | name         | perm_status | method | path               | creator_id | desc |
+----+--------------+-------------+--------+--------------------+------------+------+
|  2 | 组织删除     |           1 | POST   | /api/v1/org/delete |          1 |      |
+----+--------------+-------------+--------+--------------------+------------+------+
1 row in set (0.00 sec)
mysql>

mysql> select * from bs_role_permission where permission_id=2;
+----+---------+---------------+--------+------------+---------------------+---------------------+
| id | role_id | permission_id | status | creator_id | created_at          | updated_at          |
+----+---------+---------------+--------+------------+---------------------+---------------------+
|  2 |       1 |             2 |      1 |          1 | 2020-05-14 17:57:18 | 2020-05-29 11:45:21 |
+----+---------+---------------+--------+------------+---------------------+---------------------+
1 row in set (0.00 sec)
mysql>


mysql> select * from bs_user_role where user_id=1;
+----+---------+---------+--------+------------+---------------------+---------------------+
| id | user_id | role_id | status | creator_id | created_at          | updated_at          |
+----+---------+---------+--------+------------+---------------------+---------------------+
|  1 |       1 |       1 |      1 |          1 | 2020-05-12 16:34:10 | 2020-05-29 11:53:46 |
|  2 |       1 |       2 |      1 |          1 | 2020-05-14 15:29:22 | 2020-05-29 11:53:46 |
+----+---------+---------+--------+------------+---------------------+---------------------+
2 rows in set (0.00 sec)
mysql>

