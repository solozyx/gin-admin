
{
    "email":"18813141886@163.com"
}
{
    "code": 0,
    "msg": "SUCCESS"
}

> db.verify_code.find()
>
> db.verify_code.find()
{ "_id" : ObjectId("5ef3129b6adcd63554380715"), "code" : "983285", "account_no" : "18813141886@163.com", "created_at" : ISODate("2020-06-24T08:45:15.581Z") }
>

{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/mine/emailcode{\"email\":\"18813141886@163.com\"}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-06-24T16:45:15+08:00"}
{"level":"debug","msg":"server sign: 4d9d8fd9027959163d70f4d6f26cae91, \tuser sign: 4d9d8fd9027959163d70f4d6f26cae91","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T16:45:15+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/emailcode JWT 不验证token","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T16:45:15+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/emailcode middleware Casbin 不验证权限","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T16:45:15+08:00"}
{"level":"debug","msg":"mineService EmailCode req={Email:18813141886@163.com}","source":"mine.go:179:handler.(*mineHandler).EmailCode.func1","time":"2020-06-24T16:45:15+08:00"}
{"level":"error","msg":"userRepo SetVerifyCode 获取验证码 accountNo=18813141886@163.com error=not found","source":"mine.go:178:service.(*mineService).EmailCode","time":"2020-06-24T16:45:15+08:00"}
{"level":"debug","msg":"userRepo SetVerifyCode 写入验证码1成功","source":"mine.go:178:service.(*mineService).EmailCode","time":"2020-06-24T16:45:15+08:00"}


{
    "email":"18813141886@163.com"
}
{
    "code": 20103,
    "msg": "验证码还在有效期内; 18813141886@163.com"
}

{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/mine/emailcode{\"email\":\"18813141886@163.com\"}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-06-24T16:46:55+08:00"}
{"level":"debug","msg":"server sign: 4d9d8fd9027959163d70f4d6f26cae91, \tuser sign: 4d9d8fd9027959163d70f4d6f26cae91","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T16:46:55+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/emailcode JWT 不验证token","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T16:46:55+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/emailcode middleware Casbin 不验证权限","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T16:46:55+08:00"}
{"level":"debug","msg":"mineService EmailCode req={Email:18813141886@163.com}","source":"mine.go:179:handler.(*mineHandler).EmailCode.func1","time":"2020-06-24T16:46:55+08:00"}
{"level":"debug","msg":"userRepo SetVerifyCode accountNo=18813141886@163.com 验证码还在有效期内","source":"mine.go:178:service.(*mineService).EmailCode","time":"2020-06-24T16:46:55+08:00"}
{"level":"error","msg":"验证码还在有效期内; 18813141886@163.com","source":"casbin.go:39:middleware.CasbinVerifyUserPermission.func1","time":"2020-06-24T16:46:55+08:00"}



{
    "account_no":"18813141886@163.com",
    "verify_code":"684803"
}
{
    "code": 20110,
    "msg": "校验验证码错误; 684803"
}

{
    "account_no":"18813141886@163.com",
    "verify_code":"684804"
}
{
    "code": 0,
    "msg": "SUCCESS"
}


> db.verify_code.find()
>
>
> db.verify_code.find()
{ "_id" : ObjectId("5ef31deb6adcd64ef4303b29"), "code" : "684804", "account_no" : "18813141886@163.com", "created_at" : ISODate("2020-06-24T09:33:31.077Z") }
>

> db.verify_code.getIndexes()
[
	{
		"v" : 2,
		"key" : {
			"_id" : 1
		},
		"name" : "_id_",
		"ns" : "backstage.verify_code"
	},
	{
		"v" : 2,
		"key" : {
			"account_no" : 1
		},
		"name" : "account_no_1",
		"ns" : "backstage.verify_code"
	},
	{
		"v" : 2,
		"key" : {
			"created_at" : 1
		},
		"name" : "created_at_1",
		"ns" : "backstage.verify_code",
		"expireAfterSeconds" : 300
	}
]
>

{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/mine/emailcode{\"email\":\"18813141886@163.com\"}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-06-24T17:33:31+08:00"}
{"level":"debug","msg":"server sign: 4d9d8fd9027959163d70f4d6f26cae91, \tuser sign: 4d9d8fd9027959163d70f4d6f26cae91","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:33:31+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/emailcode JWT 不验证token","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:33:31+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/emailcode middleware Casbin 不验证权限","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:33:31+08:00"}
{"level":"debug","msg":"mineService EmailCode req={Email:18813141886@163.com}","source":"mine.go:179:handler.(*mineHandler).EmailCode.func1","time":"2020-06-24T17:33:31+08:00"}
{"level":"error","msg":"userRepo SetVerifyCode 获取验证码 accountNo=18813141886@163.com error=not found","source":"mine.go:183:service.(*mineService).EmailCode","time":"2020-06-24T17:33:31+08:00"}
{"level":"debug","msg":"mgoVerifyCodeRepo Create 耗时 = 8 毫秒","source":"user.go:146:repository.(*userRepo).SetVerifyCode","time":"2020-06-24T17:33:31+08:00"}
{"level":"debug","msg":"userRepo SetVerifyCode 写入验证码1成功","source":"mine.go:183:service.(*mineService).EmailCode","time":"2020-06-24T17:33:31+08:00"}
{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/mine/confirmcode{\"account_no\":\"18813141886@163.com\",\"verify_code\":\"684803\"}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-06-24T17:34:02+08:00"}
{"level":"debug","msg":"server sign: 188efb6f120654ffc854db2334147caf, \tuser sign: ad9bf12974769e62f7913a49608c9545","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:34:02+08:00"}
{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/mine/confirmcode{\"account_no\":\"18813141886@163.com\",\"verify_code\":\"684803\"}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-06-24T17:34:17+08:00"}
{"level":"debug","msg":"server sign: 188efb6f120654ffc854db2334147caf, \tuser sign: 188efb6f120654ffc854db2334147caf","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:34:17+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/confirmcode JWT 不验证token","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:34:17+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/confirmcode middleware Casbin 不验证权限","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:34:17+08:00"}
{"level":"debug","msg":"mineService ConfirmVerifyCode req={AccountNo:18813141886@163.com VerifyCode:684803}","source":"mine.go:216:handler.(*mineHandler).ConfirmVerifyCode.func1","time":"2020-06-24T17:34:17+08:00"}
{"level":"error","msg":"校验验证码错误; 684803","source":"casbin.go:39:middleware.CasbinVerifyUserPermission.func1","time":"2020-06-24T17:34:17+08:00"}
{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/mine/confirmcode{\"account_no\":\"18813141886@163.com\",\"verify_code\":\"684804\"}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-06-24T17:35:04+08:00"}
{"level":"debug","msg":"server sign: 3fcfaf782058d5a408f61ef27b1374d7, \tuser sign: 188efb6f120654ffc854db2334147caf","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:35:04+08:00"}
{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/mine/confirmcode{\"account_no\":\"18813141886@163.com\",\"verify_code\":\"684804\"}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-06-24T17:35:18+08:00"}
{"level":"debug","msg":"server sign: 3fcfaf782058d5a408f61ef27b1374d7, \tuser sign: 3fcfaf782058d5a408f61ef27b1374d7","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:35:18+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/confirmcode JWT 不验证token","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:35:18+08:00"}
{"level":"debug","msg":"request uri=/api/v1/mine/confirmcode middleware Casbin 不验证权限","source":"context.go:161:gin.(*Context).Next","time":"2020-06-24T17:35:18+08:00"}
{"level":"debug","msg":"mineService ConfirmVerifyCode req={AccountNo:18813141886@163.com VerifyCode:684804}","source":"mine.go:216:handler.(*mineHandler).ConfirmVerifyCode.func1","time":"2020-06-24T17:35:18+08:00"}

