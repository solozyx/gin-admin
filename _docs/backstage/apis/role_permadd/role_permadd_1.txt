
mysql> select * from bs_role_permission where role_id=4;
Empty set (0.00 sec)
mysql>

1 root
dbe31da2af50d0350a9618f66e65e4ad
{
 "role_id":4,
 "perm_ids":[14]
}
{
    "code": 0,
    "msg": "SUCCESS"
}


{"level":"debug","msg":"sign before: POST127.0.0.1:3000/api/v1/role/permadd{\"perm_ids\":[14],\"role_id\":4}1234567890com.obencn.secondchase.3671e28d-e384-49e6-9cea-4d8cb80288d4","source":"head.go:116:middleware.Options","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"server sign: dbe31da2af50d0350a9618f66e65e4ad, \tuser sign: dbe31da2af50d0350a9618f66e65e4ad","source":"context.go:161:gin.(*Context).Next","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"request uri=/api/v1/role/permadd JWT 验证token","source":"context.go:161:gin.(*Context).Next","time":"2020--25T23:21:03+08:00"}
{"level":"debug","msg":"request token=eyJhbGciOiJIUzI1NiIsImN0eSI6IkpXVCIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzZWNvbmRjaGFzZS5nYXRld2F5Iiwic3ViIjoiQWNjZXNzVG9rZW4iLCJhdWQiOiJodHRwczovL2JhY2tzdGFnZS5vYmVuY24uY29tIiwiZXhwIjoxNTkwNTA2MDY2LCJuYmYiOjE1OTA0MTkzNjYsImlhdCI6MTU5MDQxOTY2NiwianRpIjoiZTA4YWIyYzUtYjY5Zi00OWYxLWI5NmItOTExMWY0YmY3YzczIiwidXNlcl9pZCI6MX0.FODBKDaG4TqB1uItKc9A4hwix6fy-CyFrN9dV9We-VY","source":"context.go:161:gin.(*Context).Next","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"request uri=/api/v1/role/permadd middleware Casbin 验证权限","source":"context.go:161:gin.(*Context).Next",e":"2020-05-25T23:21:03+08:00"}
2020/05/25 23:21:03 Request: 1, /api/v1/role/permadd, POST ---> true
{"level":"debug","msg":"roleService PermAdd req={RoleId:4 PermIds:[14]}","source":"role.go:68:handler.(*roleHandler).PermAdd.func1","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/user_role.go:6225.08966msSELECT * FROM `bs_user_role`  WHERE (status=? AND user_id=?)[1 1] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/role_permission.go:5116.707967msSELECT * FROM `bs_role_permission`  WHERE (status=? AND role_id=?)[1 1] 13","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6719.628187msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[1] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6718.596502msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[2] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6718.623013msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[3] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6727.95769msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[4] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6721.941271msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[5] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6733.866035msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[6] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6716.04789msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[7] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6720.577235msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[8] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6717.90798msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[9] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6729.847578msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[10] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6716.614703msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[11] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6719.917598msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[12] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:6719.875979msSELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[13] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"roleService PermAdd 当前操作[角色权限添加]的用户 s.UserId=1 可用权限列表 mPerms=map[1:{} 2:{} 3:{} 4:{} 5:{{} 10:{} 11:{} 12:{} 13:{}]","source":"role.go:68:handler.(*roleHandler).PermAdd.func1","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"roleService PermAdd 待添加权限的角色 roleId=4 可添加权限列表 mRoleCanAddPermIds=map[14:{}]","source":"role.*roleHandler).PermAdd.func1","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/role_permission.go:4119.792361msSELECT * FROM `bs_role_permission`  WHERE (role_id=?)[4] 0","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"roleService PermAdd 待添加权限的角色 roleId=4 已有权限列表 rolePerms=[]","source":"role.go:68:handler.(*rolAdd.func1","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"roleService PermAdd 待添加权限的角色 roleId=4 可用权限列表 userNormalRoles=[]","source":"role.go:68:handler).PermAdd.func1","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"roleService PermAdd 待添加权限的角色 roleId=4 禁用权限列表 userDisabledRoles=[]","source":"role.go:68:handler).PermAdd.func1","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"roleService PermAdd 待添加权限的角色 roleId=4 最终可添加权限列表 mRoleCanAddPermIds=map[14:{}]","source":"r.(*roleHandler).PermAdd.func1","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/role_permission.go:3218.722229msINSERT INTO `bs_role_permission` (`role_id`,`permission_id`,`status`,`creator_id`,`created_at`,`updated_at`) VALUES (?,?,?,?,?,?)[4 14 1 1 2020-05-25 23:21:03.558953 +0800 CST m=+11.014640768 2020-05-25 23:21:03.568278 +0800 CST m=+11.023964973] 1","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/role.go:5927.213129msSELECT * FROM `bs_role`  WHERE (role_status=?)[1] 14","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"roleRepo GetAll role_status=1 from MySQL list=[{ID:1 Name:系统管理员 RoleStatus:1 CreatorId:0 Desc: Created20-05-12 15:45:15 +0800 CST UpdatedAt:2020-05-14 17:41:55 +0800 CST} {ID:2 Name:子管理员1 RoleStatus:1 CreatorId:1 Desc: CreatedAt:-05-12 15:45:37 +0800 CST UpdatedAt:2020-05-14 17:43:02 +0800 CST} {ID:3 Name:子管理员2 RoleStatus:1 CreatorId:1 Desc: CreatedAt:205-14 18:19:46 +0800 CST UpdatedAt:2020-05-14 18:19:46 +0800 CST} {ID:4 Name:子管理员3 RoleStatus:1 CreatorId:1 Desc: CreatedAt:202015 11:32:28 +0800 CST UpdatedAt:2020-05-15 11:32:28 +0800 CST} {ID:5 Name:子管理员4 RoleStatus:1 CreatorId:1 Desc: CreatedAt:2020-0 11:33:37 +0800 CST UpdatedAt:2020-05-15 11:33:37 +0800 CST} {ID:6 Name:子管理员5 RoleStatus:1 CreatorId:1 Desc: CreatedAt:2020-05-3:41:58 +0800 CST UpdatedAt:2020-05-15 13:52:21 +0800 CST} {ID:7 Name:子管理员6 RoleStatus:1 CreatorId:1 Desc:子管理员7的描述 Creat5-15 14:03:07 +0800 CST UpdatedAt:2020-05-15 14:42:28 +0800 CST} {ID:8 Name:编辑1 RoleStatus:1 CreatorId:2 Desc: CreatedAt:2020-05- 14:39:57 +0800 CST UpdatedAt:2020-05-15 14:39:57 +0800 CST} {ID:9 Name:审核1 RoleStatus:1 CreatorId:2 Desc: CreatedAt:2020-05-15 141:15 +0800 CST UpdatedAt:2020-05-15 14:41:15 +0800 CST} {ID:10 Name:编辑2 RoleStatus:1 CreatorId:2 Desc: CreatedAt:2020-05-18 14:041 +0800 CST UpdatedAt:2020-05-18 14:02:41 +0800 CST} {ID:11 Name:审核2 RoleStatus:1 CreatorId:2 Desc: CreatedAt:2020-05-18 14:20:2+0800 CST UpdatedAt:2020-05-18 14:20:24 +0800 CST} {ID:12 Name:编辑3 RoleStatus:1 CreatorId:2 Desc: CreatedAt:2020-05-18 16:16:05 +00 CST UpdatedAt:2020-05-18 16:16:05 +0800 CST} {ID:13 Name:审核3 RoleStatus:1 CreatorId:2 Desc: CreatedAt:2020-05-18 17:24:04 +080CST UpdatedAt:2020-05-18 17:24:04 +0800 CST} {ID:14 Name:编辑4 RoleStatus:1 CreatorId:2 Desc: CreatedAt:2020-05-18 18:31:28 +0800 C UpdatedAt:2020-05-18 18:31:28 +0800 CST}]","source":"casbin_adapter.go:39:adapter.(*CasbinAdapter).loadRolePolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/permission.go:8124.372821msSELECT * FROM `bs_permission`  WHERE (permission_status=?)[1] 13","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"permissionRepo GetAll permission_status=1 from MySQL list=[{ID:1 Name:权限列表 PermissionStatus:1 Method:GEth:/api/v1/permission/list CreatorId:1 Desc: CreatedAt:2020-05-14 17:28:03 +0800 CST UpdatedAt:2020-05-14 17:36:15 +0800 CST} {ID:2 Name:创建角色 PermissionStatus:1 Method:POST Path:/api/v1/role/create CreatorId:1 Desc: CreatedAt:2020-05-14 17:29:01 +0800 CST UpdAt:2020-05-14 17:34:17 +0800 CST} {ID:3 Name:角色权限添加 PermissionStatus:1 Method:POST Path:/api/v1/role/permadd CreatorId:1 DesatedAt:2020-05-14 18:02:24 +0800 CST UpdatedAt:2020-05-25 16:48:18 +0800 CST} {ID:4 Name:角色权限减少 PermissionStatus:1 Method:POS:/api/v1/role/permreduce CreatorId:1 Desc: CreatedAt:2020-05-14 18:06:01 +0800 CST UpdatedAt:2020-05-25 16:48:09 +0800 CST} {ID:5 Name:用户角色添加 PermissionStatus:1 Method:POST Path:/api/v1/user/roleadd CreatorId:1 Desc: CreatedAt:2020-05-15 14:50:46 +0800 CSTedAt:2020-05-25 16:47:49 +0800 CST} {ID:6 Name:用户角色减少 PermissionStatus:1 Method:POST Path:/api/v1/user/rolereduce CreatorId:1 CreatedAt:2020-05-15 14:51:59 +0800 CST UpdatedAt:2020-05-25 16:47:30 +0800 CST} {ID:7 Name:内容审核 PermissionStatus:1 Method:POSth:/api/v1/content/audit CreatorId:1 Desc: CreatedAt:2020-05-15 14:53:53 +0800 CST UpdatedAt:2020-05-15 14:53:53 +0800 CST} {ID:8 Name:内容发布 PermissionStatus:1 Method:POST Path:/api/v1/content/publish CreatorId:1 Desc: CreatedAt:2020-05-15 14:55:04 +0800 CST tedAt:2020-05-15 14:55:04 +0800 CST} {ID:9 Name:创建权限 PermissionStatus:1 Method:POST Path:/api/v1/permission/create CreatorId:1 : CreatedAt:2020-05-15 15:06:14 +0800 CST UpdatedAt:2020-05-15 15:06:14 +0800 CST} {ID:10 Name:创建部门 PermissionStatus:1 Method:PPath:/api/v1/department/create CreatorId:1 Desc: CreatedAt:2020-05-15 15:06:56 +0800 CST UpdatedAt:2020-05-21 13:54:13 +0800 CST} {ID:11 Name:创建用户 PermissionStatus:1 Method:POST Path:/api/v1/user/create CreatorId:1 Desc: CreatedAt:2020-05-19 15:51:52 +0800 CpdatedAt:2020-05-21 13:54:23 +0800 CST} {ID:12 Name:删除用户 PermissionStatus:1 Method:POST Path:/api/v1/user/delete CreatorId:1 DeCreatedAt:2020-05-19 17:22:07 +0800 CST UpdatedAt:2020-05-21 13:46:32 +0800 CST} {ID:13 Name:冻结用户 PermissionStatus:1 Method:POSth:/api/v1/user/disable CreatorId:1 Desc: CreatedAt:2020-05-21 14:35:14 +0800 CST UpdatedAt:2020-05-21 14:35:14 +0800 CST}]","source":"casbin_adapter.go:47:adapter.(*CasbinAdapter).loadRolePolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/role_permission.go:6118.321504msSELECT * FROM `bs_role_permission`  [] 41","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"rolePermissionRepo GetAll from MySQL list=[{ID:1 RoleId:1 PermissionId:1 Status:1 CreatorId:0 CreatedAt:2020-05-12 16:48:04 +0800 CST UpdatedAt:2020-05-12 22:55:25 +0800 CST} {ID:2 RoleId:1 PermissionId:2 Status:1 CreatorId:0 CreatedAt:2020-05-14 17:57:18 +0800 CST UpdatedAt:2020-05-14 17:57:18 +0800 CST} {ID:3 RoleId:1 PermissionId:3 Status:1 CreatorId:0 CreatedAt:2020-05-14 18:08:40 +0800 CST UpdatedAt:2020-05-14 18:08:40 +0800 CST} {ID:4 RoleId:1 PermissionId:4 Status:1 CreatorId:0 CreatedAt:2020-05-14 18:09:33 +0800 CST UpdatedAt:2020-05-14 18:09:33 +0800 CST} {ID:5 RoleId:2 PermissionId:1 Status:1 CreatorId:0 CreatedAt:2020-05-14 18:23:28 +0800 CST UpdatedAt:2020-05-14 18:23:28 +0800 CST} {ID:7 RoleId:1 PermissionId:5 Status:1 CreatorId:0 CreatedAt:2020-05-15 14:56:54 +0800 CST UpdatedAt:2020-05-15 14:56:54 +0800 CST} {ID:8 RoleId:1 PermissionId:6 Status:1 CreatorId:0 CreatedAt:2020-05-15 14:57:07 +0800 CST UpdatedAt:2020-05-15 14:57:07 +0800 CST} {ID:9 RoleId:1 PermissionId:7 Status:1 CreatorId:0 CreatedAt:2020-05-15 14:57:21 +0800 CST UpdatedAt:2020-05-15 14:57:21 +0800 CST} {ID:10 RoleId:1 PermissionId:8 Status:1 CreatorId:0 CreatedAt:2020-05-15 14:57:35 +0800 CST UpdatedAt:2020-05-15 14:57:35 +0800 CST} {ID:11 RoleId:2 PermissionId:3 Status:1 CreatorId:0 CreatedAt:2020-05-15 15:03:23 +0800 CST UpdatedAt:2020-05-15 15:03:23 +0800 CST} {ID:12 RoleId:2 PermissionId:4 Status:1 CreatorId:0 CreatedAt:2020-05-15 15:03:42 +0800 CST UpdatedAt:2020-05-15 15:03:42 +0800 CST} {ID:13 RoleId:2 PermissionId:5 Status:1 CreatorId:0 CreatedAt:2020-05-15 15:03:52 +0800 CST UpdatedAt:2020-05-15 15:03:52 +0800 CST} {ID:14 RoleId:2 PermissionId:6 Status:1 CreatorId:0 CreatedAt:2020-05-15 15:04:02 +0800 CST UpdatedAt:2020-05-15 15:04:02 +0800 CST} {ID:15 RoleId:2 PermissionId:7 Status:1 CreatorId:0 CreatedAt:2020-05-15 15:04:13 +0800 CST UpdatedAt:2020-05-15 15:04:13 +0800 CST} {ID:16 RoleId:2 PermissionId:8 Status:1 CreatorId:0 CreatedAt:2020-05-15 15:04:23 +0800 CST UpdatedAt:2020-05-15 15:04:23 +0800 CST} {ID:17 RoleId:1 PermissionId:9 Status:1 CreatorId:0 CreatedAt:2020-05-15 15:10:56 +0800 CST UpdatedAt:2020-05-15 15:10:56 +0800 CST} {ID:18 RoleId:1 PermissionId:10 Status:1 CreatorId:0 CreatedAt:2020-05-15 15:11:10 +0800 CST UpdatedAt:2020-05-15 15:11:10 +0800 CST} {ID:19 RoleId:8 PermissionId:5 Status:1 CreatorId:0 CreatedAt:2020-05-15 17:40:13 +0800 CST UpdatedAt:2020-05-15 17:40:13 +0800 CST} {ID:20 RoleId:8 PermissionId:6 Status:1 CreatorId:0 CreatedAt:2020-05-15 17:40:13 +0800 CST UpdatedAt:2020-05-15 17:40:13 +0800 CST} {ID:21 RoleId:9 PermissionId:7 Status:1 CreatorId:0 CreatedAt:2020-05-15 17:45:11 +0800 CST UpdatedAt:2020-05-15 17:45:11 +0800 CST} {ID:22 RoleId:9 PermissionId:8 Status:1 CreatorId:0 CreatedAt:2020-05-15 17:45:11 +0800 CST UpdatedAt:2020-05-15 17:45:11 +0800 CST} {ID:23 RoleId:10 PermissionId:5 Status:1 CreatorId:0 CreatedAt:2020-05-18 14:06:38 +0800 CST UpdatedAt:2020-05-18 14:06:38 +0800 CST} {ID:24 RoleId:10 PermissionId:6 Status:1 CreatorId:0 CreatedAt:2020-05-18 14:06:38 +0800 CST UpdatedAt:2020-05-18 14:06:38 +0800 CST} {ID:25 RoleId:11 PermissionId:7 Status:1 CreatorId:0 CreatedAt:2020-05-18 14:21:56 +0800 CST UpdatedAt:2020-05-18 14:21:56 +0800 CST} {ID:26 RoleId:11 PermissionId:8 Status:1 CreatorId:0 CreatedAt:2020-05-18 14:21:56 +0800 CST UpdatedAt:2020-05-18 14:21:56 +0800 CST} {ID:27 RoleId:3 PermissionId:5 Status:1 CreatorId:0 CreatedAt:2020-05-18 17:09:01 +0800 CST UpdatedAt:2020-05-18 17:09:01 +0800 CST} {ID:28 RoleId:3 PermissionId:6 Status:1 CreatorId:0 CreatedAt:2020-05-18 17:11:44 +0800 CST UpdatedAt:2020-05-18 17:11:44 +0800 CST} {ID:29 RoleId:13 PermissionId:7 Status:1 CreatorId:0 CreatedAt:2020-05-18 17:24:44 +0800 CST UpdatedAt:2020-05-18 17:24:44 +0800 CST} {ID:30 RoleId:13 PermissionId:8 Status:1 CreatorId:0 CreatedAt:2020-05-18 17:24:44 +0800 CST UpdatedAt:2020-05-18 17:24:44 +0800 CST} {ID:31 RoleId:12 PermissionId:5 Status:1 CreatorId:0 CreatedAt:2020-05-18 18:01:34 +0800 CST UpdatedAt:2020-05-18 18:01:34 +0800 CST} {ID:32 RoleId:12 PermissionId:6 Status:1 CreatorId:0 CreatedAt:2020-05-18 18:23:18 +0800 CST UpdatedAt:2020-05-18 18:23:18 +0800 CST} {ID:33 RoleId:14 PermissionId:5 Status:1 CreatorId:0 CreatedAt:2020-05-18 18:32:20 +0800 CST UpdatedAt:2020-05-18 18:32:20 +0800 CST} {ID:34 RoleId:14 PermissionId:6 Status:1 CreatorId:0 CreatedAt:2020-05-18 18:34:15 +0800 CST UpdatedAt:2020-05-18 18:34:15 +0800 CST} {ID:35 RoleId:14 PermissionId:1 Status:1 CreatorId:0 CreatedAt:2020-05-18 18:36:04 +0800 CST UpdatedAt:2020-05-18 18:36:04 +0800 CST} {ID:36 RoleId:1 PermissionId:11 Status:1 CreatorId:0 CreatedAt:2020-05-19 15:54:09 +0800 CST UpdatedAt:2020-05-19 15:54:09 +0800 CST} {ID:52 RoleId:1 PermissionId:12 Status:1 CreatorId:0 CreatedAt:2020-05-21 13:56:57 +0800 CST UpdatedAt:2020-05-21 13:56:57 +0800 CST} {ID:53 RoleId:2 PermissionId:12 Status:1 CreatorId:0 CreatedAt:2020-05-21 13:57:11 +0800 CST UpdatedAt:2020-05-21 13:57:11 +0800 CST} {ID:54 RoleId:2 PermissionId:11 Status:1 CreatorId:0 CreatedAt:2020-05-21 14:01:02 +0800 CST UpdatedAt:2020-05-21 14:01:02 +0800 CST} {ID:55 RoleId:1 PermissionId:13 Status:1 CreatorId:0 CreatedAt:2020-05-21 14:37:19 +0800 CST UpdatedAt:2020-05-21 14:37:20 +0800 CST} {ID:56 RoleId:2 PermissionId:13 Status:1 CreatorId:0 CreatedAt:2020-05-21 14:37:30 +0800 CST UpdatedAt:2020-05-21 14:37:30 +0800 CST} {ID:57 RoleId:4 PermissionId:14 Status:1 CreatorId:1 CreatedAt:2020-05-25 23:21:04 +0800 CST UpdatedAt:2020-05-25 23:21:04 +0800 CST}]","source":"casbin_adapter.go:56:adapter.(*CasbinAdapter).loadRolePolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/permission/list,GET","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/role/create,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/role/permadd,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/role/permreduce,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/user/roleadd,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/user/rolereduce,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/content/audit,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/content/publish,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/permission/create,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/department/create,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/user/create,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/user/delete,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,1,/api/v1/user/disable,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/permission/list,GET","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/role/permadd,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/role/permreduce,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/user/roleadd,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/user/rolereduce,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/content/audit,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/content/publish,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/user/delete,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/user/create,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,2,/api/v1/user/disable,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,3,/api/v1/user/roleadd,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,3,/api/v1/user/rolereduce,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,8,/api/v1/user/roleadd,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,8,/api/v1/user/rolereduce,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,9,/api/v1/content/audit,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,9,/api/v1/content/publish,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,10,/api/v1/user/roleadd,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,10,/api/v1/user/rolereduce,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,11,/api/v1/content/audit,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,11,/api/v1/content/publish,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,12,/api/v1/user/roleadd,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,12,/api/v1/user/rolereduce,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,13,/api/v1/content/audit,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,13,/api/v1/content/publish,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,14,/api/v1/user/roleadd,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,14,/api/v1/user/rolereduce,POST","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadRolePolicy line=p,14,/api/v1/permission/list,GET","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"CasbinAdapter loadRolePolicy casbinModel.Model m=map[e:map[e:0xc000480300] g:map[g:0xc000480540] m:map[m:0xc0004803c0] p:map[p:0xc0004804e0] r:map[r:0xc000480480]]","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"CasbinAdapter loadRolePolicy casbinModel.Model m[e][e]=\u0026{Key:e Value:some(where (p_eft == allow)) Tokens:[] Policy:[] RM:\u003cnil\u003e}","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"CasbinAdapter loadRolePolicy casbinModel.Model m[g][g]=\u0026{Key:e Value:some(where (p_eft == allow)) Tokens:[] Policy:[] RM:\u003cnil\u003e}","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"CasbinAdapter loadRolePolicy casbinModel.Model m[m][m]=\u0026{Key:m Value:g(r_sub, p_sub) \u0026\u0026 keyMatch2(r_obj, p_obj) \u0026\u0026 r_act == p_act Tokens:[] Policy:[] RM:\u003cnil\u003e}","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"CasbinAdapter loadRolePolicy casbinModel.Model m[p][p]=\u0026{Key:p Value:sub, obj, act Tokens:[p_sub p_obj p_act] Policy:[[1 /api/v1/permission/list GET] [1 /api/v1/role/create POST] [1 /api/v1/role/permadd POST] [1 /api/v1/role/permreduce POST] [1 /api/v1/user/roleadd POST] [1 /api/v1/user/rolereduce POST] [1 /api/v1/content/audit POST] [1 /api/v1/content/publish POST] [1 /api/v1/permission/create POST] [1 /api/v1/department/create POST] [1 /api/v1/user/create POST] [1 /api/v1/user/delete POST] [1 /api/v1/user/disable POST] [2 /api/v1/permission/list GET] [2 /api/v1/role/permadd POST] [2 /api/v1/role/permreduce POST] [2 /api/v1/user/roleadd POST] [2 /api/v1/user/rolereduce POST] [2 /api/v1/content/audit POST] [2 /api/v1/content/publish POST] [2 /api/v1/user/delete POST] [2 /api/v1/user/create POST] [2 /api/v1/user/disable POST] [3 /api/v1/user/roleadd POST] [3 /api/v1/user/rolereduce POST] [8 /api/v1/user/roleadd POST] [8 /api/v1/user/rolereduce POST] [9 /api/v1/content/audit POST] [9 /api/v1/content/publish POST] [10 /api/v1/user/roleadd POST] [10 /api/v1/user/rolereduce POST] [11 /api/v1/content/audit POST] [11 /api/v1/content/publish POST] [12 /api/v1/user/roleadd POST] [12 /api/v1/user/rolereduce POST] [13 /api/v1/content/audit POST] [13 /api/v1/content/publish POST] [14 /api/v1/user/roleadd POST] [14 /api/v1/user/rolereduce POST] [14 /api/v1/permission/list GET]] RM:\u003cnil\u003e}","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"CasbinAdapter loadRolePolicy casbinModel.Model m[r][r]=\u0026{Key:r Value:sub, obj, act Tokens:[r_sub r_obj r_act] Policy:[] RM:\u003cnil\u003e}","source":"casbin_adapter.go:25:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/user.go:17026.903294msSELECT * FROM `bs_user`  WHERE (user_status=?)[1] 9","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"userRepo GetAll user_status=1 from MySQL list=[{ID:1 DepartmentId:0 Name:root Password:d6cf393ff29f1b223052a63891ef52bca7697e85 RealName:超级管理员 Email:root@email.com Phone:18813141001 UserStatus:1 CreatorId:0 Desc:最高权限用户 CreatedA2 14:58:40 +0800 CST UpdatedAt:2020-05-20 13:37:36 +0800 CST} {ID:2 DepartmentId:1 Name:user1 Password:d6cf393ff29f1b223052a63891ef52bca7697e85 RealName:管理员1 Email:user1@email.com Phone:18813141002 UserStatus:1 CreatorId:1 Desc:普通权限用户1 CreatedAt:2020-05:14 +0800 CST UpdatedAt:2020-05-20 13:37:36 +0800 CST} {ID:3 DepartmentId:1 Name:user2 Password:d6cf393ff29f1b223052a63891ef52bca7697e85 RealName:管理员2 Email:user2@email.com Phone:18813141003 UserStatus:1 CreatorId:1 Desc:普通权限用户2 CreatedAt:2020-05-18 11:00 CST UpdatedAt:2020-05-20 13:37:36 +0800 CST} {ID:4 DepartmentId:1 Name:user3 Password:d6cf393ff29f1b223052a63891ef52bca7697e85 RealName:管理员3 Email:user3@email.com Phone:18813141004 UserStatus:1 CreatorId:1 Desc:普通权限用户3 CreatedAt:2020-05-18 14:17:39 +UpdatedAt:2020-05-20 13:37:36 +0800 CST} {ID:5 DepartmentId:1 Name:user4 Password:d6cf393ff29f1b223052a63891ef52bca7697e85 RealName:管理员4 Email:user4@email.com Phone:18813141005 UserStatus:1 CreatorId:1 Desc:普通权限用户4 CreatedAt:2020-05-18 17:22:38 +0800 CSAt:2020-05-20 13:37:36 +0800 CST} {ID:6 DepartmentId:1 Name:user5 Password:d6cf393ff29f1b223052a63891ef52bca7697e85 RealName:管理员mail:user5@email.com Phone:18813141006 UserStatus:1 CreatorId:1 Desc:普通权限用户5 CreatedAt:2020-05-18 18:28:59 +0800 CST UpdatedA-05-20 13:37:36 +0800 CST} {ID:7 DepartmentId:1 Name:user6 Password:d6cf393ff29f1b223052a63891ef52bca7697e85 RealName:管理员6 Emailer6@email.com Phone:18813141007 UserStatus:1 CreatorId:1 Desc:普通权限用户6 CreatedAt:2020-05-19 17:10:16 +0800 CST UpdatedAt:2020-16:05:08 +0800 CST} {ID:10 DepartmentId:1 Name:user9new Password:2ceaf92638986db196e4973e718b58c19bda80df RealName:姓名9new Email:ur9@email.com Phone:18800000009 UserStatus:1 CreatorId:2 Desc:备注描述9 CreatedAt:2020-05-20 16:57:16 +0800 CST UpdatedAt:2020-05-2115:17 +0800 CST} {ID:11 DepartmentId:1 Name:user10 Password:d6cf393ff29f1b223052a63891ef52bca7697e85 RealName:姓名10 Email:user10@eil.com Phone:18800000010 UserStatus:1 CreatorId:2 Desc:备注描述10 CreatedAt:2020-05-22 17:03:35 +0800 CST UpdatedAt:2020-05-22 17:0 +0800 CST}]","source":"casbin_adapter.go:98:adapter.(*CasbinAdapter).loadUserPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"info","msg":"sql/Users/zhaoyingxin/Documents/oben/backstage/repository/user_role.go:4113.846247msSELECT * FROM `bs_user_role`  [] 18","source":"scope.go:1047:gorm.(*Scope).trace","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"userRoleRepo GetAll from MySQL list=[{ID:1 UserId:1 RoleId:1 Status:1 CreatorId:0 CreatedAt:2020-05-12 16:34:10 +0800 CST UpdatedAt:2020-05-14 18:24:07 +0800 CST} {ID:2 UserId:2 RoleId:2 Status:1 CreatorId:0 CreatedAt:2020-05-14 15:29:22 +0800 CST UpdatedAt:2020-05-14 18:24:37 +0800 CST} {ID:3 UserId:2 RoleId:10 Status:1 CreatorId:0 CreatedAt:2020-05-18 14:02:41 +0800 CST UpdatedAt:2020-05-18 14:02:41 +0800 CST} {ID:4 UserId:3 RoleId:10 Status:1 CreatorId:0 CreatedAt:2020-05-18 14:09:40 +0800 CST UpdatedAt:2020-05-18 14:09:40 +0800 CST} {ID:5 UserId:2 RoleId:11 Status:1 CreatorId:0 CreatedAt:2020-05-18 14:20:24 +0800 CST UpdatedAt:2020-05-18 14:20:24 +0800 CST} {ID:6 UserId:4 RoleId:11 Status:1 CreatorId:0 CreatedAt:2020-05-18 14:23:15 +0800 CST UpdatedAt:2020-05-18 14:23:15 +0800 CST} {ID:7 UserId:2 RoleId:12 Status:1 CreatorId:0 CreatedAt:2020-05-18 16:16:05 +0800 CST UpdatedAt:2020-05-18 16:16:05 +0800 CST} {ID:8 UserId:2 RoleId:13 Status:1 CreatorId:0 CreatedAt:2020-05-18 17:24:04 +0800 CST UpdatedAt:2020-05-18 17:24:04 +0800 CST} {ID:9 UserId:5 RoleId:13 Status:1 CreatorId:0 CreatedAt:2020-05-18 17:27:38 +0800 CST UpdatedAt:2020-05-18 17:27:38 +0800 CST} {ID:10 UserId:5 RoleId:12 Status:1 CreatorId:0 CreatedAt:2020-05-18 18:04:01 +0800 CST UpdatedAt:2020-05-18 18:04:01 +0800 CST} {ID:11 UserId:2 RoleId:14 Status:1 CreatorId:0 CreatedAt:2020-05-18 18:31:28 +0800 CST UpdatedAt:2020-05-18 18:31:28 +0800 CST} {ID:12 UserId:6 RoleId:14 Status:1 CreatorId:0 CreatedAt:2020-05-18 18:32:52 +0800 CST UpdatedAt:2020-05-18 18:32:52 +0800 CST} {ID:13 UserId:11 RoleId:10 Status:1 CreatorId:0 CreatedAt:2020-05-22 17:38:17 +0800 CST UpdatedAt:2020-05-22 17:38:17 +0800 CST} {ID:14 UserId:0 RoleId:0 Status:1 CreatorId:2 CreatedAt:2020-05-25 14:39:35 +0800 CST UpdatedAt:2020-05-25 14:46:56 +0800 CST} {ID:15 UserId:7 RoleId:10 Status:1 CreatorId:2 CreatedAt:2020-05-25 14:48:22 +0800 CST UpdatedAt:2020-05-25 14:48:22 +0800 CST} {ID:16 UserId:8 RoleId:10 Status:0 CreatorId:2 CreatedAt:2020-05-25 14:53:23 +0800 CST UpdatedAt:2020-05-25 17:29:04 +0800 CST} {ID:17 UserId:0 RoleId:0 Status:1 CreatorId:2 CreatedAt:2020-05-25 15:10:28 +0800 CST UpdatedAt:2020-05-25 15:18:29 +0800 CST} {ID:18 UserId:8 RoleId:11 Status:0 CreatorId:2 CreatedAt:2020-05-25 15:27:46 +0800 CST UpdatedAt:2020-05-25 17:29:04 +0800 CST}]","source":"casbin_adapter.go:106:adapter.(*CasbinAdapter).loadUserPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,1,1","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,2,2","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,2,10","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,2,11","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,2,12","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,2,13","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,2,14","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,3,10","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,4,11","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,5,13","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,5,12","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,6,14","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,7,10","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy line=g,11,10","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy casbinModel.Model m=map[e:map[e:0xc000480300] g:map[g:0xc000480540] m:map[m:0xc0004803c0] p:map[p:0xc0004804e0] r:map[r:0xc000480480]]","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy casbinModel.Model m[e][e]=\u0026{Key:e Value:some(where (p_eft == allow)) Tokens:[] Policy:[] RM:\u003cnil\u003e}","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy casbinModel.Model m[g][g]=\u0026{Key:g Value:_, _ Tokens:[] Policy:[[1 1] [2 2] [2 10] [2 11] [2 12] [2 13] [2 14] [3 10] [4 11] [5 13] [5 12] [6 14] [7 10] [11 10]] RM:0xc000492260}","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy casbinModel.Model m[m][m]=\u0026{Key:m Value:g(r_sub, p_sub) \u0026\u0026 keyMatch2(r_obj, p_obj) \u0026\u0026 r_act == p_act Tokens:[] Policy:[] RM:\u003cnil\u003e}","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy casbinModel.Model m[p][p]=\u0026{Key:p Value:sub, obj, act Tokens:[p_sub p_obj p_act] Policy:[[1 /api/v1/permission/list GET] [1 /api/v1/role/create POST] [1 /api/v1/role/permadd POST] [1 /api/v1/role/permreduce POST] [1 /api/v1/user/roleadd POST] [1 /api/v1/user/rolereduce POST] [1 /api/v1/content/audit POST] [1 /api/v1/content/publish POST] [1 /api/v1/permission/create POST] [1 /api/v1/department/create POST] [1 /api/v1/user/create POST] [1 /api/v1/user/delete POST] [1 /api/v1/user/disable POST] [2 /api/v1/permission/list GET] [2 /api/v1/role/permadd POST] [2 /api/v1/role/permreduce POST] [2 /api/v1/user/roleadd POST] [2 /api/v1/user/rolereduce POST] [2 /api/v1/content/audit POST] [2 /api/v1/content/publish POST] [2 /api/v1/user/delete POST] [2 /api/v1/user/create POST] [2 /api/v1/user/disable POST] [3 /api/v1/user/roleadd POST] [3 /api/v1/user/rolereduce POST] [8 /api/v1/user/roleadd POST] [8 /api/v1/user/rolereduce POST] [9 /api/v1/content/audit POST] [9 /api/v1/content/publish POST] [10 /api/v1/user/roleadd POST] [10 /api/v1/user/rolereduce POST] [11 /api/v1/content/audit POST] [11 /api/v1/content/publish POST] [12 /api/v1/user/roleadd POST] [12 /api/v1/user/rolereduce POST] [13 /api/v1/content/audit POST] [13 /api/v1/content/publish POST] [14 /api/v1/user/roleadd POST] [14 /api/v1/user/rolereduce POST] [14 /api/v1/permission/list GET]] RM:\u003cnil\u003e}","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
{"level":"debug","msg":"CasbinAdapter loadUserPolicy casbinModel.Model m[r][r]=\u0026{Key:r Value:sub, obj, act Tokens:[r_sub r_obj r_act] Policy:[] RM:\u003cnil\u003e}","source":"casbin_adapter.go:29:adapter.(*CasbinAdapter).LoadPolicy","time":"2020-05-25T23:21:03+08:00"}
2020/05/25 23:21:03 Policy:
2020/05/25 23:21:03 p: sub, obj, act: [[1 /api/v1/permission/list GET] [1 /api/v1/role/create POST] [1 /api/v1/role/permadd POST] [1 /api/v1/role/permreduce POST] [1 /api/v1/user/roleadd POST] [1 /api/v1/user/rolereduce POST] [1 /api/v1/content/audit POST] [1 /api/v1/content/publish POST] [1 /api/v1/permission/create POST] [1 /api/v1/department/create POST] [1 /api/v1/user/create POST] [1 /api/v1/user/delete POST] [1 /api/v1/user/disable POST] [2 /api/v1/permission/list GET] [2 /api/v1/role/permadd POST] [2 /api/v1/role/permreduce POST] [2 /api/v1/user/roleadd POST] [2 /api/v1/user/rolereduce POST] [2 /api/v1/content/audit POST] [2 /api/v1/content/publish POST] [2 /api/v1/user/delete POST] [2 /api/v1/user/create POST] [2 /api/v1/user/disable POST] [3 /api/v1/user/roleadd POST] [3 /api/v1/user/rolereduce POST] [8 /api/v1/user/roleadd POST] [8 /api/v1/user/rolereduce POST] [9 /api/v1/content/audit POST] [9 /api/v1/content/publish POST] [10 /api/v1/user/roleadd POST] [10 /api/v1/user/rolereduce POST] [11 /api/v1/content/audit POST] [11 /api/v1/content/publish POST] [12 /api/v1/user/roleadd POST] [12 /api/v1/user/rolereduce POST] [13 /api/v1/content/audit POST] [13 /api/v1/content/publish POST] [14 /api/v1/user/roleadd POST] [14 /api/v1/user/rolereduce POST] [14 /api/v1/permission/list GET]]
2020/05/25 23:21:03 g: _, _: [[1 1] [2 2] [2 10] [2 11] [2 12] [2 13] [2 14] [3 10] [4 11] [5 13] [5 12] [6 14] [7 10] [11 10]]
2020/05/25 23:21:03 Role links for: g
2020/05/25 23:21:03 1 < 1, 3 < 10, 6 < 14, 2 < (2, 10, 11, 12, 13, 14), 11 < 10, 4 < 11, 5 < (13, 12), 7 < 10













mysql> select * from bs_role_permission where role_id=4;
+----+---------+---------------+--------+------------+---------------------+---------------------+
| id | role_id | permission_id | status | creator_id | created_at          | updated_at          |
+----+---------+---------------+--------+------------+---------------------+---------------------+
| 57 |       4 |            14 |      1 |          1 | 2020-05-25 23:21:04 | 2020-05-25 23:21:04 |
+----+---------+---------------+--------+------------+---------------------+---------------------+
1 row in set (0.00 sec)
mysql>










2020/05/25 23:21:03 Request: 1, /api/v1/role/permadd, POST ---> true
roleService PermAdd req={RoleId:4 PermIds:[14]}

SELECT * FROM `bs_user_role`  WHERE (status=? AND user_id=?)[1 1] 1

SELECT * FROM `bs_role_permission`  WHERE (status=? AND role_id=?)[1 1] 13
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[1] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[2] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[3] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[4] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[5] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[6] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[7] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[8] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[9] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[10] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[11] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[12] 1
SELECT * FROM `bs_permission`  WHERE (id=?) ORDER BY `bs_permission`.`id` ASC LIMIT 1[13] 1
roleService PermAdd 当前操作[角色权限添加]的用户 s.UserId=1 可用权限列表 mPerms=map[1:{} 2:{} 3:{} 4:{} 5:{{} 10:{} 11:{} 12:{} 13:{}]

roleService PermAdd 待添加权限的角色 roleId=4 可添加权限列表 mRoleCanAddPermIds=map[14:{}]

SELECT * FROM `bs_role_permission`  WHERE (role_id=?)[4] 0
roleService PermAdd 待添加权限的角色 roleId=4 已有权限列表 rolePerms=[]
roleService PermAdd 待添加权限的角色 roleId=4 可用权限列表 userNormalRoles=[]
roleService PermAdd 待添加权限的角色 roleId=4 禁用权限列表 userDisabledRoles=[]
roleService PermAdd 待添加权限的角色 roleId=4 最终可添加权限列表 mRoleCanAddPermIds=map[14:{}]

INSERT INTO `bs_role_permission` (`role_id`,`permission_id`,`status`,`creator_id`,`created_at`,`updated_at`) VALUES (?,?,?,?,?,?)
[4 14 1 1 2020-05-25 23:21:03.558953 +0800 CST m=+11.014640768 2020-05-25 23:21:03.568278 +0800 CST m=+11.023964973] 1

